% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/unified_validation.R
\name{unified_validation}
\alias{unified_validation}
\title{Perform Pairwise Heterogeneous Treatment Effect Calibration Across Multiple Drugs}
\usage{
unified_validation(
  data,
  drug_var,
  drugs,
  prediction_vars,
  outcome_var,
  cal_groups,
  matching = FALSE,
  adjustment_var = NULL,
  matching_var = adjustment_var,
  match.exact = NULL,
  match.antiexact = NULL
)
}
\arguments{
\item{data}{A data.frame containing observed outcomes, treatment assignments, and predicted outcomes for each drug.}

\item{drug_var}{Character string specifying the column name of the treatment variable (e.g., assigned drug).}

\item{drugs}{Character vector of two or more drug names to be compared pairwise.}

\item{prediction_vars}{Character vector of column names corresponding to predicted outcomes for each drug.
Must be the same length and order as \code{drugs}.}

\item{outcome_var}{Character string specifying the column name of the observed outcome variable.}

\item{cal_groups}{Numeric scalar or vector specifying the number(s) of calibration groups (quantiles) to partition
the population for subgroup analysis.}

\item{matching}{Logical; if \code{TRUE}, performs covariate matching using the \code{MatchIt} package before estimating effects.}

\item{adjustment_var}{Optional character vector of covariate column names to adjust for in regression models.}

\item{matching_var}{Optional character vector specifying variables to match on. Defaults to \code{adjustment_var} if NULL.}

\item{match.exact}{Optional character vector of variables for exact matching. The best predicted drug is always included.}

\item{match.antiexact}{Optional character vector of variables for anti-exact matching. The treatment variable is always included.}
}
\value{
A data.frame with one row per calibration group and drug pair combination, including:
\describe{
\item{cal_groups}{Number of calibration groups used.}
\item{grouping}{Calibration group identifier (e.g., 1 through \code{cal_groups}).}
\item{mean}{Mean predicted benefit in the calibration group.}
\item{coef}{Estimated treatment effect (regression coefficient) within the group.}
\item{coef_low}{Lower bound of the 95\% confidence interval for the estimate.}
\item{coef_high}{Upper bound of the 95\% confidence interval.}
\item{drug1}{Name of the first drug in the pair.}
\item{n_drug1}{Number of patients in the group receiving the first drug.}
\item{drug2}{Name of the second drug in the pair.}
\item{n_drug2}{Number of patients in the group receiving the second drug.}
}
}
\description{
This function computes heterogeneous treatment effect calibration curves for all pairwise comparisons
between a specified set of drugs. For each pair, it calculates the predicted benefit (difference between
predicted outcomes), partitions patients into calibration groups based on predicted benefit quantiles,
and estimates treatment effects within each group.
}
\details{
Internally, the function calls \code{calibration_hte()} for each drug pair to obtain
subgroup treatment effect estimates and confidence intervals.
}
\examples{
\dontrun{
# Example usage comparing 3 drugs with predicted outcomes
results <- unified_validation(
  data = mydata,
  drug_var = "treatment",
  drugs = c("DrugA", "DrugB", "DrugC"),
  prediction_vars = c("pred_drugA", "pred_drugB", "pred_drugC"),
  outcome_var = "outcome",
  cal_groups = c(3, 5),        # test 3 and 5 calibration groups
  adjustment_var = c("age", "sex"),
  matching = TRUE
)
head(results)
}

}
